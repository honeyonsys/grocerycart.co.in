<html>
<head>
<meta charset="UTF-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta content="width=device-width,initial-scale=1" name="viewport">
<meta content="description" name="grocery cart">
<meta name="google" content="notranslate" />
<meta content="grocery cart is developed by honeyonsys" name="author">

<!-- Disable tap highlight on IE -->
<meta name="msapplication-tap-highlight" content="no">
<link href="./assets/favicon.ico" rel="icon">
   
<title>Grocery cart | Groceries in whole sale rates | online groceries</title>    
<link href="assets/style.css" rel="stylesheet">
</head>
<body>
    <div class="navigationBar"></div>
    <div class="introArea">
        <div class="introLeft">
            <h1>About Grocery Cart</h1>

            <p>Grocery cart is started on late 2021. It is operating by Mr.Sunil Denis who is having wholesale network in ludhiana city. The idea for this estore is to expand the product selling in whole sale in whoe country. Currently main operations are going from the ludhiana only.</p>
        </div>
        <div class="introRight"></div>
        
    </div>
    <div class="addQuantityPopUp">
        <div class="closeAddToCartPopup" onclick="hideAddToCartPopUp()">X</div>
        <input type="hidden" id="selectedProductId" value="1"/>
        <input type="hidden" id="selectedProductName" value="Amul Buttter (500g)" />
        <input type="hidden" id="selectedProductImage" value="img-01.jpg"/>
        <input type="hidden" id="selectedProductAmount" value="180"/>
        <div class="addToCartProductDesc"></div>
        <div class="quantityIncDecArea">
            
            <button onclick="incrementDecrement('decrease')">-</button>
            <input type="number" id="qtyNumber"  min="0" max="100" value="0">
            <button onclick="incrementDecrement('increase')">+</button>
        </div>
    </div>
    <div class="contentArea">
        
        <div class="products"></div>
        <!--
        <div class="productCard">
            <div class="productImg">
                <img src="assets/images/img-01.jpg"/>
            </div>
            <div class="productDesc">
                <div class="productTitle"><b>Amul Butter 500g</b> <span>Rs.120</span></div>
                <div class="productDetail">
                    <ul>
                        <li>Weight: 500gn</li>
                        <li>Ingredients: Milk, Mixed flavour, salt</li>
                    </ul>
                </div>
                <div class="btn-primary btn">Add to Cart</div>
            </div>
        </div>
        -->
        
        
        <div class="contactDiv">
            <h3>Contact Us</h3>
            <div class="contactCard">
                <i class="fa fa-phone"></i> +91-87258-96384
            </div>
            <div class="contactCard">
                <i class="fa fa-envelope"></i> grocerycartpb@gmail.com
            </div>
            <div class="contactCard">
                <i class="fa fa-home"></i> #69, CMC Colony, Bhamian kalan, Tajpur Road, Ludhiana
            </div>
        </div>
    </div>
    
    
<script>
    //loading products from the json file
    function loadJSON(callback) {
        var xobj = new XMLHttpRequest();
        xobj.overrideMimeType("application/json");
        xobj.open('GET', 'products.json', true); // Replace 'my_data' with the path to your file
        xobj.onreadystatechange = function () {
            if (xobj.readyState == 4 && xobj.status == "200") {
                // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
                callback(xobj.responseText);
            }
        };
        xobj.send(null);
    }

    
    loadJSON(function (response) {
        // Parse JSON string into object
        var productsJSON = JSON.parse(response);
        var productList = document.querySelector(".products");
        const html = productsJSON['products'].map( item =>{
            return `
            <div class="productCard">
                <div class="productImg">
                    <img src="assets/images/${item['image']}"/>
                </div>
                <div class="productDesc">
                    <div class="productTitle"><b>${item['name']}</b></div>
                    <div class="productRate">₹.${item['amount']} <span>MRP ₹.${item['originalRate']}</span></div>
                    <div class="productDetail">
                        ${item['description']}
                    </div>
                    <div class="btn-primary cartBtn" onclick="selectProductForCart(${item['id']}, ${item['amount']}, '${item['name']}', '${item['image']}')">Add to Cart</div>
                </div>
            </div>
            `;
            });
            
            productList.innerHTML = html.join('');
    });

    function hideAddToCartPopUp(){
        document.querySelector('.addQuantityPopUp').style.visibility = 'hidden';
    }
    function selectProductForCart(productId, productAmount, productName, productImage) {
        try {
            document.querySelector('.addQuantityPopUp').style.visibility = "visible";
            let cartProducts = localStorage.getItem('Grocery-Cart');
            let jsonData = Array.from(JSON.parse(cartProducts));
            let previousQuantity = 0;

            for (var i = 0; i < jsonData.length; i++) {
                if (jsonData[i].id == productId) {
                    previousQuantity = jsonData[i].qty;
                    break;
                }
            }
            let fieldQuantity = document.querySelector('#qtyNumber');
            let fieldProductId = document.querySelector('#selectedProductId');
            let fieldProductName = document.querySelector('#selectedProductName');
            let fieldProductAmount = document.querySelector('#selectedProductAmount');
            let fieldProductImage = document.querySelector('#selectedProductImage');
            let productNameArea = document.querySelector('.addToCartProductDesc');
            fieldQuantity.value = previousQuantity;
            fieldProductId.value = productId;
            fieldProductName.value = productName;
            fieldProductAmount.value = productAmount;
            fieldProductImage.value = productImage;
            productNameArea.innerHTML = productName + ", ₹"+productAmount;
            
        }
        catch(err) {
            console.log("Error: " + err.message);
        }
    }
    function addtocart(productId, productAmount, productName, productImage) {
        try {
            var cartProducts = localStorage.getItem('Grocery-Cart');
            var jsonData = Array.from(JSON.parse(cartProducts));
            var isProductAddedInCart = 0;

            for (var i = 0; i < jsonData.length; i++) {
                if (jsonData[i].id == productId) {
                    isProductAddedInCart = 1;
                    break;
                }
            }
            if(isProductAddedInCart == 0) {
                jsonData.push({"id": productId, "amount": productAmount, "qty": 1, "productName": productName, "productImage": productImage});
                refreshCartCount(jsonData.length);
                localStorage.setItem('Grocery-Cart', JSON.stringify(jsonData));
            }
        
        }
        catch(err) {
            console.log("Error: " + err.message);
        }
        
    }
    function updateQuantity(productId, quantity) {
        try {
            var cartProducts = localStorage.getItem('Grocery-Cart');
            var jsonData = Array.from(JSON.parse(cartProducts));
            for (var i = 0; i < jsonData.length; i++) {
                if (jsonData[i].id == productId) {
                    jsonData[i].qty = quantity;
                    break;
                }
            }
            localStorage.setItem('Grocery-Cart', JSON.stringify(jsonData));
        }
        catch(err) {
            console.log("Error: " + err.message);
        }
    }
    // setting up cart key in localstorage
    let cartProducts = localStorage.getItem('Grocery-Cart');
    if(cartProducts == null) {
        localStorage.setItem('Grocery-Cart', '[]');
    }

    function incrementDecrement(operator) {
        let quantity = document.querySelector('#qtyNumber');
        let productId = document.querySelector('#selectedProductId');
        let productName = document.querySelector('#selectedProductName');
        let productAmount = document.querySelector('#selectedProductAmount');
        let productImage = document.querySelector('#selectedProductImage');
        let quantityNumber = parseInt(quantity.value);
        if(quantityNumber == 0) {
            addtocart(productId.value, productAmount.value, productName.value, productImage.value);
        } else if(quantityNumber > 0) {
            updateQuantity(productId.value, quantityNumber);
        }
        operator === 'increase' ? quantity.stepUp() : quantity.stepDown();
        
    }

    
    
    
</script>
<script src="main.js"></script>

</body>
</html>